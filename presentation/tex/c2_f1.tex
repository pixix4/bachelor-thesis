\section{Welche Konsistenzbeziehungen bestehen zwischen BPMN- und BROS-Modellen?}

\begin{frame}{Konsistenzproblem}
  Eine \textbf{Inkonsistenz} tritt genau dann auf, wenn eine Konsistenzregel verletzt wird.

  Eine \textbf{Konsistenzregel} ist eine Formalisierung von einem Aspekt der Konsistenz zwischen den betrachteten Modellen.

  Das \textbf{Konsistenzproblem} beschreibt den Vorgang der Minimierung und Verhinderung von Inkonsistenzen mit Hilfe der Aufstellung und Prüfung von Konsistenzregeln.

  TODO: Referenzen, Konsistenz
\end{frame}

\begin{frame}{Business Process Model and Notation}
  \begin{figure}
    \centering
    \begin{adjustbox}{width=1.1\linewidth,center}
      \includegraphics{images/example/bpmn.pdf}
    \end{adjustbox}
  \end{figure}
\end{frame}
\begin{frame}{Business Role-Object Specification}
  \begin{figure}
    \centering
    \begin{adjustbox}{width=0.9\linewidth,center}
      \includegraphics{images/example/bros-rule6.png}
    \end{adjustbox}
  \end{figure}
\end{frame}

\begin{frame}[fragile]{Prolog-Datenstrukutr}
\begin{lstlisting}[language=Prolog]
% Definition aller BPMN Elemente.
bpmn(Bpmn, Type).

% Definition aller BROS Elemente.
bros(Bros, Type).

% Definition aller Relationen.
relation(Source, Target, Type).

% Definition der Eltern-Kind Beziehung.
parent(Child, Parent).
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]{Hilfsfunktionen}
\begin{lstlisting}[language=Prolog]
% Konsistenz der Eltern-Kind Beziehung.
check_parent(C) :- 
  parent(C, P), parent(C, Q) -> P == Q.

% Transitiver Abschluss der Modellstruktur.
transitive_parent(Child, Parent).

% Orakel für das Matching von Modellelementen.
match(Bpmn, Bros).
\end{lstlisting}
\end{frame}

\begin{frame}{Konsistenzbeziehungen}
  \begin{figure}
    \centering
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_1_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 1: BPMN-Process}}%
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_2_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 2: BPMN-Swimlane}}%
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_3_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 3: BPMN-TerminationEvent}}%
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \vspace{4pt}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_4_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 4: BPMN-EndEvent}}%
    \end{subfigure}
    \hspace{16pt}
    \begin{subfigure}{0.3\textwidth}
        \vspace{4pt}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_5_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 5: BPMN-StartEvent}}%
    \end{subfigure}
  \end{figure}
\end{frame}

\begin{frame}{Konsistenzbeziehungen}
  \begin{figure}
    \centering
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_1_example}};
            \filldraw[draw=background,fill=background,fill opacity=0.8, draw opacity=0.8] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{\textcolor{black!20}{Regel 1: BPMN-Process}}}%
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_2_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 2: BPMN-Swimlane}}%
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_3_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 3: BPMN-TerminationEvent}}%
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \vspace{4pt}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_4_example}};
            \filldraw[draw=background,fill=background,fill opacity=0.8, draw opacity=0.8] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{\textcolor{black!20}{Regel 4: BPMN-EndEvent}}}%
    \end{subfigure}
    \hspace{16pt}
    \begin{subfigure}{0.3\textwidth}
        \vspace{4pt}
        \centering
        \begin{adjustbox}{width=0.8\linewidth,center}
          \begin{tikzpicture}
            \node at (0,0) {\input{tex/s_rule_5_example}};
            \filldraw[draw=background,fill=background,fill opacity=0, draw opacity=0] (-4,-3.5) rectangle (4,3.5);
          \end{tikzpicture}
        \end{adjustbox}
        \caption*{\tiny{Regel 5: BPMN-StartEvent}}%
    \end{subfigure}
  \end{figure}
\end{frame}

\begin{frame}{BPMN-Swimlane - BROS-RoleType}
  \begin{figure}
    \centering
    \begin{adjustbox}{width=0.5\linewidth,center}
      \input{tex/s_rule_2_example}
    \end{adjustbox}
  \end{figure}
\end{frame}
\begin{frame}[fragile]{BPMN-Swimlane - BROS-RoleType}
\begin{lstlisting}[language=Prolog]
rule_2(Bpmn) :- bpmn(Bpmn, "Swimlane") ->
  (
      bros(Bros, "RoleType"), match(Bpmn, Bros)
  ).
\end{lstlisting}
\end{frame}
\begin{frame}{BPMN-TerminationEvent - BROS-ReturnEvent}
  \begin{figure}
    \centering
    \begin{adjustbox}{width=0.5\linewidth,center}
      \input{tex/s_rule_3_example}
    \end{adjustbox}
  \end{figure}
\end{frame}
\begin{frame}[fragile]{BPMN-TerminationEvent - BROS-ReturnEvent}
\begin{lstlisting}[language=Prolog]
rule_3(Bpmn) :- bpmn(Bpmn, "TerminationEvent") ->
  (
      bros(Bros, "ReturnEvent"), 
      match(Bpmn, Bros),
      (
          parent(Bros, BrosParent),
          transitive_parent(Bpmn, BpmnParent),
          match(BpmnParent, BrosParent)
      )
  ).
\end{lstlisting}
\end{frame}
\begin{frame}{BPMN-StartEvent - BROS-Event}
  \begin{figure}
    \centering
    \begin{adjustbox}{width=0.5\linewidth,center}
      \input{tex/s_rule_5_example}
    \end{adjustbox}
  \end{figure}
\end{frame}
\begin{frame}[fragile]{BPMN-StartEvent - BROS-Event}
\begin{lstlisting}[language=Prolog]
rule_5(Bpmn) :- bpmn(Bpmn, "StartEvent") ->
  (
      bros(Bros, "Event"),
      match(Bpmn, Bros),
      (
          relation(Bros, X, "CreateRelation"),
          transitive_parent(Bpmn, BpmnParent),
          match(BpmnParent, X)
      )
  ).
\end{lstlisting}
\end{frame}